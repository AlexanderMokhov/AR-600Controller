      SUBROUTINE       PRAV
      IMPLICIT REAL*4 (M,J,A-H,O-Z) 
      REAL GV(1),GR(1),CU1(3),CU2(3),CU3(3)
      INTEGER MLLG
      COMMON/DXTK/DXS
      COMMON/NOMERUS/NOMERUS
      COMMON/IVELO/KODVEL
      COMMON/UGOLXPRF/UGOL_X
      COMMON /WAY/ SKOLES(10)
      COMMON /UPR/KVAR,V,DV,H,HZ,KODR,S,SO,KVARNU,KODN
      COMMON /UGR/ KGR1,KGR2,T
      COMMON /LOCP/ FX(9999),IX(100)
      COMMON /CMLLG/ MLLG
      COMMON /CACSEL/IACSEL,ACSEL(6000)
      INTEGER MNSE1
      COMMON/NAPCOS/KSEH1,MNSE1(2000),COSSE(6000)
      INCLUDE 'SLVL.INC'
      INCLUDE 'MLINK.INC'
      INCLUDE 'COMMON'
      INCLUDE 'SILAC'
      INCLUDE 'CURVCOM.INC'
      INCLUDE 'SILACR'
      INCLUDE 'COMPAR.I77'
      INCLUDE 'COMGR.I77'
      EQUIVALENCE(GV(1),MASP01)
      COMMON/UNITM/UNITM3(9)
      COMMON/CNTUS52/NTUS52
      EQUIVALENCE (UUZ081,GR( 1566)),(TUZ081,GR( 1567))
      EQUIVALENCE (XUZ081,GR( 1568)),(YUZ081,GR( 1569))
      EQUIVALENCE (UUY075,GR( 1570)),(TUY075,GR( 1571))
      EQUIVALENCE (XUY075,GR( 1572)),(YUY075,GR( 1573))
      EQUIVALENCE (UUX076,GR( 1574)),(TUX076,GR( 1575))
      EQUIVALENCE (XUX076,GR( 1576)),(YUX076,GR( 1577))
      EQUIVALENCE (UUX074,GR( 1578)),(TUX074,GR( 1579))
      EQUIVALENCE (XUX074,GR( 1580)),(YUX074,GR( 1581))
      EQUIVALENCE (UUY059,GR( 1582)),(TUY059,GR( 1583))
      EQUIVALENCE (XUY059,GR( 1584)),(YUY059,GR( 1585))
      EQUIVALENCE (UUX071,GR( 1586)),(TUX071,GR( 1587))
      EQUIVALENCE (XUX071,GR( 1588)),(YUX071,GR( 1589))
      EQUIVALENCE (UUY077,GR( 1590)),(TUY077,GR( 1591))
      EQUIVALENCE (XUY077,GR( 1592)),(YUY077,GR( 1593))
      EQUIVALENCE (UUX072,GR( 1606)),(TUX072,GR( 1607))
      EQUIVALENCE (XUX072,GR( 1608)),(YUX072,GR( 1609))
      EQUIVALENCE (UUX063,GR( 1610)),(TUX063,GR( 1611))
      EQUIVALENCE (XUX063,GR( 1612)),(YUX063,GR( 1613))
      EQUIVALENCE (UUZ066,GR( 1618)),(TUZ066,GR( 1619))
      EQUIVALENCE (XUZ066,GR( 1620)),(YUZ066,GR( 1621))
      EQUIVALENCE (UUX067,GR( 1622)),(TUX067,GR( 1623))
      EQUIVALENCE (XUX067,GR( 1624)),(YUX067,GR( 1625))
      EQUIVALENCE (UUY068,GR( 1634)),(TUY068,GR( 1635))
      EQUIVALENCE (XUY068,GR( 1636)),(YUY068,GR( 1637))
      EQUIVALENCE (UUY073,GR( 1638)),(TUY073,GR( 1639))
      EQUIVALENCE (XUY073,GR( 1640)),(YUY073,GR( 1641))
      EQUIVALENCE (UUY078,GR( 1642)),(TUY078,GR( 1643))
      EQUIVALENCE (XUY078,GR( 1644)),(YUY078,GR( 1645))
      EQUIVALENCE (UUY079,GR( 1646)),(TUY079,GR( 1647))
      EQUIVALENCE (XUY079,GR( 1648)),(YUY079,GR( 1649))
      EQUIVALENCE (UUX058,GR( 1650)),(TUX058,GR( 1651))
      EQUIVALENCE (XUX058,GR( 1652)),(YUX058,GR( 1653))
      EQUIVALENCE (UUZ080,GR( 1658)),(TUZ080,GR( 1659))
      EQUIVALENCE (XUZ080,GR( 1660)),(YUZ080,GR( 1661))
      EQUIVALENCE (UUY064,GR( 1662)),(TUY064,GR( 1663))
      EQUIVALENCE (XUY064,GR( 1664)),(YUY064,GR( 1665))
      EQUIVALENCE (UUZ069,GR( 1666)),(TUZ069,GR( 1667))
      EQUIVALENCE (XUZ069,GR( 1668)),(YUZ069,GR( 1669))
      EQUIVALENCE (UUY065,GR( 1670)),(TUY065,GR( 1671))
      EQUIVALENCE (XUY065,GR( 1672)),(YUY065,GR( 1673))
      EQUIVALENCE (UUY070,GR( 1674)),(TUY070,GR( 1675))
      EQUIVALENCE (XUY070,GR( 1676)),(YUY070,GR( 1677))
      EQUIVALENCE (S02401,GR( 1426))
      EQUIVALENCE (S03401,GR( 1430))
      EQUIVALENCE (S04401,GR( 1434))
C  GENGEO
      EQUIVALENCE(EMAAAE,GV(  469))
      EQUIVALENCE(EMAAAF,GV(  470))
      EQUIVALENCE(EMAAAG,GV(  471))
C +EMAAAE+EMAAAF+EMAAAG
C  GENGEO äéçÖñ
C  GENA
      EQUIVALENCE(EMAAAH,GR( 1171))
      EQUIVALENCE(EMAAAI,GR( 1172))
      EQUIVALENCE(EMAAAJ,GR( 1173))
      EQUIVALENCE(EMAAAK,GR( 1174))
      EQUIVALENCE(EMAAAL,GR( 1175))
      EQUIVALENCE(EMAAAM,GR( 1176))
      EQUIVALENCE(EMAAAN,GR( 1177))
      EQUIVALENCE(EMAAAO,GR( 1178))
      EQUIVALENCE(EMAAAP,GR( 1179))
      EQUIVALENCE (S02413,GR( 1455))
      EQUIVALENCE (S03413,GR( 1459))
      EQUIVALENCE (S04413,GR( 1463))
      EQUIVALENCE (S02431,GR( 1467))
      EQUIVALENCE (S03431,GR( 1471))
      EQUIVALENCE (S04431,GR( 1475))
C  GENGEO
      EQUIVALENCE(EMAAAS,GV(  424))
      EQUIVALENCE(EMAAAT,GV(  419))
      EQUIVALENCE(EMAAAU,GV(  418))
C +EMAAAS+EMAAAT+EMAAAU+EMAAAH+EMAAAI+EMAA
C  GENGEO äéçÖñ
C  GENA
      EQUIVALENCE(EMAAAV,GR( 1436))
      EQUIVALENCE(EMAAAW,GR( 1437))
      EQUIVALENCE(EMAAAX,GR( 1438))
      EQUIVALENCE(EMAAAY,GR( 1439))
      EQUIVALENCE(EMAAAZ,GR( 1440))
      EQUIVALENCE(EMAAA_,GR( 1441))
      EQUIVALENCE(EMAAA$,GR( 1442))
      EQUIVALENCE(EMAAA2,GR( 1443))
      EQUIVALENCE(EMAAA3,GR( 1444))
C  GENOM
      EQUIVALENCE(EMAAA9,GR(  298))
      EQUIVALENCE(EMAABA,GR(  299))
      EQUIVALENCE(EMAAA5,GR(  300))
C   GENOM äéçÖñ
C  GENOM
      EQUIVALENCE(EMAABO,GR(  298))
      EQUIVALENCE(EMAABP,GR(  299))
      EQUIVALENCE(EMAABK,GR(  300))
C   GENOM äéçÖñ
C VEKSUM   
C VEKSUM END
C  GENOM
C   GENOM äéçÖñ
C  GENOM
C   GENOM äéçÖñ
C  GENOM
C   GENOM äéçÖñ
C  GENOM
C   GENOM äéçÖñ
      EQUIVALENCE (S02449,GR( 1479))
      EQUIVALENCE (S03449,GR( 1483))
      EQUIVALENCE (S04449,GR( 1487))
C  GENGEO
      EQUIVALENCE(EMAAB5,GV(  425))
      EQUIVALENCE(EMAAB6,GV(  421))
      EQUIVALENCE(EMAAB7,GV(  420))
C +EMAAB5+EMAAB6+EMAAB7+EMAAAV+EMAAAW+EMAA
C  GENGEO äéçÖñ
C  GENOM
C   GENOM äéçÖñ
C  GENOM
C   GENOM äéçÖñ
C VEKSUM   
C VEKSUM END
C  GENOM
C   GENOM äéçÖñ
C  GENOM
C   GENOM äéçÖñ
C  GENOM
C   GENOM äéçÖñ
C  GENOM
C   GENOM äéçÖñ
      EQUIVALENCE (S02467,GR( 1491))
      EQUIVALENCE (S03467,GR( 1495))
      EQUIVALENCE (S04467,GR( 1499))
C  GENGEO
      EQUIVALENCE(EMAACL,GV(  426))
      EQUIVALENCE(EMAACM,GV(  423))
      EQUIVALENCE(EMAACN,GV(  422))
C +EMAACL+EMAACM+EMAACN+EMAAAV+EMAAAW+EMAA
C  GENGEO äéçÖñ
C  GENOM
C   GENOM äéçÖñ
C  GENOM
C   GENOM äéçÖñ
C VEKSUM   
C VEKSUM END
C  GENOM
C   GENOM äéçÖñ
C  GENOM
C   GENOM äéçÖñ
C  GENOM
C   GENOM äéçÖñ
C  GENOM
C   GENOM äéçÖñ
      EQUIVALENCE (S02485,GR( 1503))
      EQUIVALENCE (S03485,GR( 1507))
      EQUIVALENCE (S04485,GR( 1511))
C  GENGEO
      EQUIVALENCE(EMAAC2,GV(  490))
      EQUIVALENCE(EMAAC3,GV(  491))
      EQUIVALENCE(EMAAC4,GV(  492))
C +EMAAC2+EMAAC3+EMAAC4+EMAAAV+EMAAAW+EMAA
C  GENGEO äéçÖñ
      EQUIVALENCE (S02497,GR( 1515))
      EQUIVALENCE (S03497,GR( 1519))
      EQUIVALENCE (S04497,GR( 1523))
      EQUIVALENCE (S02509,GR( 1527))
      EQUIVALENCE (S03509,GR( 1531))
      EQUIVALENCE (S04509,GR( 1535))
      EQUIVALENCE (S02521,GR( 1556))
      EQUIVALENCE (S03521,GR( 1560))
      EQUIVALENCE (S04521,GR( 1564))
C  END PREPARE    1
      EQUIVALENCE (SSS502,GR( 1794))
      EQUIVALENCE (SSS504,GR( 1798))
      EQUIVALENCE (SSS506,GR( 1802))
      EQUIVALENCE (SSS507,GR( 1806))
      EQUIVALENCE (SSS509,GR( 1810))
      EQUIVALENCE (SSS511,GR( 1814))
      EQUIVALENCE (SSS513,GR( 1818))
      EQUIVALENCE (SSS515,GR( 1822))
      EQUIVALENCE (SSS516,GR( 1826))
      EQUIVALENCE (SSS518,GR( 1830))
      EQUIVALENCE (SSS520,GR( 1834))
      EQUIVALENCE (SSS522,GR( 1838))
      EQUIVALENCE (SSS524,GR( 1842))
      EQUIVALENCE (SSS525,GR( 1846))
      EQUIVALENCE (SSS527,GR( 1850))
      EQUIVALENCE (SSS529,GR( 1854))
      EQUIVALENCE (SSS531,GR( 1858))
      EQUIVALENCE (SSS533,GR( 1862))
      EQUIVALENCE (SSS534,GR( 1866))
      EQUIVALENCE (SSS536,GR( 1870))
      EQUIVALENCE (SSS538,GR( 1874))
      EQUIVALENCE (SSS540,GR( 1878))
      EQUIVALENCE (SSS542,GR( 1882))
      EQUIVALENCE (SSS544,GR( 1886))
      EQUIVALENCE (SSS546,GR( 1890))
      EQUIVALENCE (SSS548,GR( 1894))
      EQUIVALENCE (SSS550,GR( 1898))
      EQUIVALENCE (SSS552,GR( 1902))
      EQUIVALENCE (SSS554,GR( 1906))
      EQUIVALENCE (SSS555,GR( 1910))
      EQUIVALENCE (SSS557,GR( 1914))
      EQUIVALENCE (SSS559,GR( 1918))
      EQUIVALENCE (SSS561,GR( 1922))
C  GENA
      EQUIVALENCE(EM0031,GR( 1269))
      EQUIVALENCE(EM0032,GR( 1270))
      EQUIVALENCE(EM0033,GR( 1271))
      EQUIVALENCE(EM0034,GR( 1272))
      EQUIVALENCE(EM0035,GR( 1273))
      EQUIVALENCE(EM0036,GR( 1274))
      EQUIVALENCE(EM0037,GR( 1275))
      EQUIVALENCE(EM0038,GR( 1276))
      EQUIVALENCE(EM0039,GR( 1277))
C  GENA
      EQUIVALENCE(EM1420,GR(  937))
      EQUIVALENCE(EM1421,GR(  938))
      EQUIVALENCE(EM1422,GR(  939))
      EQUIVALENCE(EM1423,GR(  940))
      EQUIVALENCE(EM1424,GR(  941))
      EQUIVALENCE(EM1425,GR(  942))
      EQUIVALENCE(EM1426,GR(  943))
      EQUIVALENCE(EM1427,GR(  944))
      EQUIVALENCE(EM1428,GR(  945))
C  GENA
      EQUIVALENCE(EM1489,GR(  686))
      EQUIVALENCE(EM1490,GR(  687))
      EQUIVALENCE(EM1491,GR(  688))
      EQUIVALENCE(EM1492,GR(  689))
      EQUIVALENCE(EM1493,GR(  690))
      EQUIVALENCE(EM1494,GR(  691))
      EQUIVALENCE(EM1495,GR(  692))
      EQUIVALENCE(EM1496,GR(  693))
      EQUIVALENCE(EM1497,GR(  694))
C  GENA
      EQUIVALENCE(EM1558,GR( 1537))
      EQUIVALENCE(EM1559,GR( 1538))
      EQUIVALENCE(EM1560,GR( 1539))
      EQUIVALENCE(EM1561,GR( 1540))
      EQUIVALENCE(EM1562,GR( 1541))
      EQUIVALENCE(EM1563,GR( 1542))
      EQUIVALENCE(EM1564,GR( 1543))
      EQUIVALENCE(EM1565,GR( 1544))
      EQUIVALENCE(EM1566,GR( 1545))
      EQUIVALENCE(XL0100,GR(1))
       IF(MLLG.NE.1)CALL PRAVL
       IF(MLLG.EQ.1)CALL CALCACS
      W=V*T
      IF(KODVEL.EQ.1)W=0.0
      WMOST1=W+DXS
      CALL FSHCALL
           ELX054=0.0
           ELZ054=0.0
           ELX053=0.0
           ELY053=0.0
           ELZ053=0.0
           ELY052=0.0
           ELZ052=0.0
           ELX051=0.0
           ELY051=0.0
           ELZ051=0.0
           ELX050=0.0
           ELY050=0.0
           ELX049=0.0
           ELY049=0.0
           ELZ049=0.0
           ELY040=0.0
           ELZ040=0.0
           ELX039=0.0
           ELY039=0.0
           ELZ039=0.0
           ELX096=0.0
           ELY096=0.0
           ELY036=0.0
           ELZ036=0.0
           ELX035=0.0
           ELY035=0.0
           ELZ035=0.0
           ELX086=0.0
           ELY086=0.0
           ELX034=0.0
           ELZ034=0.0
           ELX033=0.0
           ELY033=0.0
           ELZ033=0.0
           ELX031=0.0
           ELY031=0.0
           ELZ031=0.0
           ELX088=0.0
           ELY088=0.0
           ELX032=0.0
           ELZ032=0.0
           ELX028=0.0
           ELZ028=0.0
           ELX027=0.0
           ELY027=0.0
           ELZ027=0.0
           ELX090=0.0
           ELY090=0.0
           ELY030=0.0
           ELZ030=0.0
           ELX029=0.0
           ELY029=0.0
           ELZ029=0.0
           ELX095=0.0
           ELY095=0.0
           ELY024=0.0
           ELZ024=0.0
           ELX023=0.0
           ELY023=0.0
           ELZ023=0.0
           ELX087=0.0
           ELY087=0.0
           ELX022=0.0
           ELZ022=0.0
           ELX021=0.0
           ELY021=0.0
           ELZ021=0.0
           ELX019=0.0
           ELY019=0.0
           ELZ019=0.0
           ELX089=0.0
           ELY089=0.0
           ELX020=0.0
           ELZ020=0.0
           ELX018=0.0
           ELZ018=0.0
           ELX017=0.0
           ELY017=0.0
           ELZ017=0.0
           ELX091=0.0
           ELY091=0.0
           ELY016=0.0
           ELZ016=0.0
           ELX015=0.0
           ELY015=0.0
           ELZ015=0.0
           ELY099=0.0
           ELX098=0.0
           ELY098=0.0
           ELX097=0.0
           ELY097=0.0
           ELZ097=0.0
           ELX026=0.0
           ELY026=0.0
           ELZ026=0.0
           ELX025=0.0
           ELY025=0.0
           ELX014=0.0
           ELY014=0.0
           ELX013=0.0
           ELY013=0.0
           ELZ013=0.0
           ELX012=0.0
           ELY012=0.0
           ELZ012=0.0
           ELX004=0.0
           ELY004=0.0
           ELZ004=0.0
           ELY003=0.0
           ELZ003=0.0
           ELY094=0.0
           ELX048=0.0
           ELZ048=0.0
           ELX047=0.0
           ELY047=0.0
           ELZ047=0.0
           ELX038=0.0
           ELY038=0.0
           ELZ038=0.0
           ELX037=0.0
           ELZ037=0.0
           ELX011=0.0
           ELY011=0.0
           ELX002=0.0
           ELY002=0.0
           ELZ002=0.0
           ELX001=0.0
           ELZ001=0.0
           ELX101=0.0
           ELY101=0.0
           ELZ101=0.0
           ELX113=0.0
           ELY113=0.0
           ELZ113=0.0
           ELX131=0.0
           ELY131=0.0
           ELZ131=0.0
           ELX149=0.0
           ELY149=0.0
           ELZ149=0.0
           ELX167=0.0
           ELY167=0.0
           ELZ167=0.0
           ELX185=0.0
           ELY185=0.0
           ELZ185=0.0
           ELX197=0.0
           ELY197=0.0
           ELZ197=0.0
           ELX209=0.0
           ELY209=0.0
           ELZ209=0.0
           ELX221=0.0
           ELY221=0.0
           ELZ221=0.0
      XUZ081=+ZU0800-ZU0700
      YUZ081=+ZW0800-ZW0700
      EUZ081=FUZ018(XUZ081,YUZ081,UUZ081,TUZ081)
      XUY075=+YU1300-YU1000
      YUY075=+YW1300-YW1000
      EUY075=FUY015(XUY075,YUY075,UUY075,TUY075)
      XUX076=+XU1900-XU1800
      YUX076=+XW1900-XW1800
      EUX076=FUX016(XUX076,YUX076,UUX076,TUX076)
      XUX074=+XU1300-XU1100
      YUX074=+XW1300-XW1100
      EUX074=FUX016(XUX074,YUX074,UUX074,TUX074)
      XUY059=+YU0200-YU0100
      YUY059=+YW0200-YW0100
      EUY059=FUY009(XUY059,YUY059,UUY059,TUY059)
      XUX071=+XU0800-XU1200
      YUX071=+XW0800-XW1200
      EUX071=FUX016(XUX071,YUX071,UUX071,TUX071)
      XUY077=+YU1800-YU1700
      YUY077=+YW1800-YW1700
      EUY077=FUY015(XUY077,YUY077,UUY077,TUY077)
      XUX072=+XU1500-XU1400
      YUX072=+XW1500-XW1400
      EUX072=FUX016(XUX072,YUX072,UUX072,TUX072)
      XUX063=+XU2100-XU2000
      YUX063=+XW2100-XW2000
      EUX063=FUX022(XUX063,YUX063,UUX063,TUX063)
      XUZ066=+ZU2500-ZU2600
      YUZ066=+ZW2500-ZW2600
      EUZ066=FUZ011(XUZ066,YUZ066,UUZ066,TUZ066)
      XUX067=+XU2600-XU2700
      YUX067=+XW2600-XW2700
      EUX067=FUX012(XUX067,YUX067,UUX067,TUX067)
      XUY068=+YU2800-YU2700
      YUY068=+YW2800-YW2700
      EUY068=FUY013(XUY068,YUY068,UUY068,TUY068)
      XUY073=+YU1600-YU1500
      YUY073=+YW1600-YW1500
      EUY073=FUY015(XUY073,YUY073,UUY073,TUY073)
      XUY078=+YU1000-YU0900
      YUY078=+YW1000-YW0900
      EUY078=FUY017(XUY078,YUY078,UUY078,TUY078)
      XUY079=+YU1700-YU1600
      YUY079=+YW1700-YW1600
      EUY079=FUY017(XUY079,YUY079,UUY079,TUY079)
      XUX058=+XU0200-XU0300
      YUX058=+XW0200-XW0300
      EUX058=FUX008(XUX058,YUX058,UUX058,TUX058)
      XUZ080=+ZU0700-ZU1400
      YUZ080=+ZW0700-ZW1400
      EUZ080=FUZ018(XUZ080,YUZ080,UUZ080,TUZ080)
      XUY064=+YU2000-YU0100
      YUY064=+YW2000-YW0100
      EUY064=FUY009(XUY064,YUY064,UUY064,TUY064)
      XUZ069=+ZU0700-ZU0100
      YUZ069=+ZW0700-ZW0100
      EUZ069=FUZ014(XUZ069,YUZ069,UUZ069,TUZ069)
      XUY065=+YU2500-YU0100
      YUY065=+YW2500-YW0100
      EUY065=FUY010(XUY065,YUY065,UUY065,TUY065)
      XUY070=+YU0900-YU1200
      YUY070=+YW0900-YW1200
      EUY070=FUY015(XUY070,YUY070,UUY070,TUY070)
      CALL PRAV1
      RETURN
      END
